{
    "collab_server" : "",
    "contents" : "rm(list = ls())\nsource(\"0_functions.R\")\npacks <- c(\"foreign\", \"dplyr\", \"reshape2\", \"stringr\", \"tidyr\",\n           \"lubridate\")\nf_install_and_load(packs)\n\n# ---- read data ----\n\nd_raw <- read.spss(\"../raw_data/2003_entry_exit_matrix_all_data.sav\",\n               to.data.frame = TRUE)\nd_labels <- data.frame(name = names(d_raw),\n                       label = attr(d_raw, \"variable.labels\"))\n\n# ---- reshape data back to wide format ----\n# The dataset is put together by merging a bunch of annual datasets\n# Thus, a \"minimal dataset\" that preserves all the information is in wide format\n\nd <- d_raw %>%\n  select(order, sub_name,\n         nation, region, province, city, zip_code,\n         ind_zone, sta_pro, mode,\n         fdtn_yr, fdtn_est, yeardata, yearexit, year_e,\n         matches(\"^gm.*[0-9]{2}$\"), # nationality of subsidiary general manager\n         matches(\"^temp.*[0-9]{2}$\"), # total employees\n         matches(\"^jemp.*[0-9]{2}$\"), # Japanese employees\n         matches(\"^uscptl.*[0-9]{2}$\"), # capital invested in subsidiary\n         matches(\"^ussale.*[0-9]{2}$\"), # sales of subsidiary\n         matches(\"^prft.*[0-9]{2}$\"), # profitability of subsidiary\n         matches(\"ja1.*[0-9]{2}$\"), # ownership of primary japanese partnert\n         matches(\"^sic\") # SIC code\n         ) %>%\n  distinct()\n\nif (nrow(d) != length(d$order)) {\n  stop(\"Bad: The data is not yet reduced to its minimal form.\n       There are duplications that should not exist!\")\n} else {\n  message(\"Good: The data is reduced to its minimal form.\")\n}\n\n# ---- Save wide data ----\n\nsaveRDS(d, file = \"../clean_data/JapanFDI_wide.RData\")\n\n",
    "created" : 1457484201104.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2132440580",
    "id" : "C23546F4",
    "lastKnownWriteTime" : 1457481945,
    "last_content_update" : 1457481945,
    "path" : "~/projects/two_sided_matching/code/11_clean_japanfdi.R",
    "project_path" : "11_clean_japanfdi.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}